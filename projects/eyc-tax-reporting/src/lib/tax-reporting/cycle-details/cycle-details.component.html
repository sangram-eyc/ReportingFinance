<div class="production-cycle-details-wrapper">

  <div class="back-wrapper">
    <motif-icon class="back-button" [src]="'/assets/icons/hardware/ic_keyboard_backspace_24px.svg'"
      (click)="backtoCycleView()"></motif-icon>
    &nbsp;<span class="back-opt">&nbsp;Tax Reporting&nbsp;&nbsp;>&nbsp;&nbsp;<span
        style="font-weight: 400;">{{productCycleName}}</span></span>
  </div>

  <div class="production-cycle-details-header">
    <h1>{{pageName}}</h1>
  </div>

 <!--  <lib-shared-grid [columnDefs]="columnDefs" [rowData]="rowData" [paginationSize]="currentlySelectedPageSize.value"
    [pagination]="true" gridStyle="first" buttonPosition="left" [displayCheckBox]="true" [button]="false">
  </lib-shared-grid> -->

  <lib-shared-grid gridStyle="first" [columnDefs]="columnDefs" [rowData]="rowData" rowSelection="multiple"
  [submitFunction]="submitDatasets" buttonPosition="left" [masterDetail]="false"
  [modalConfig]="datasetsModalConfig" [detailCellRendererParams]="exceptionDetailCellRendererParams"
  (selectedRowEmitter)="datasetsReportRowsSelected($event)" [displaySecondButton]="true"
  [permissionToPrimaryButton]="true"
  [permissionToSecondaryButton]="false">
</lib-shared-grid>

<ng-template #datasetsDropdownTemplate let-row>

  <div class="complete" *ngIf="row.approvedBack === true">
    <motif-icon [src]="'../../../assets/eyc-tax-reporting/mock/icons/ic-approved-entity.svg'">
      <!-- /assets/icons/action/ic_done_24px.svg -->
    </motif-icon>
  </div>

  <div class="complete" *ngIf="row.approvedBack === false && (row.openCommentsEY > 0 || row.openCommentClient > 0) ">
    <motif-icon [src]="'../../../assets/eyc-tax-reporting/mock/icons/ic-checbox-disabled.svg'">   
    </motif-icon>
  </div>

</ng-template>

  <ng-template #fundName let-row>
    <span class="fund-name">{{row.name}}</span>
  </ng-template>

  <ng-template #urlDownload let-row>
    <div class="ml-4 grid-actions" *ngIf="row.hasContent">
      <a (click)="getDownloadFile(row)">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1"
          x="0px" y="0px" viewBox="0 0 480 480" style="enable-background:new 0 0 480 480;" xml:space="preserve"
          stroke="darkblue" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="darkblue">
          <path
            d="M378.528,214.688l-21.088-24c-5.824-6.624-15.904-7.264-22.56-1.472L272,244.32V16c0-8.832-7.168-16-16-16h-32 c-8.832,0-16,7.168-16,16v228.32l-62.88-55.104c-6.624-5.792-16.704-5.152-22.56,1.472l-21.088,23.968 c-5.856,6.656-5.184,16.8,1.472,22.624l126.528,110.752c6.048,5.28,15.04,5.28,21.088,0L377.056,237.28 C383.712,231.456,384.384,221.312,378.528,214.688z" />
          <path
            d="M416,416H64c-8.832,0-16,7.168-16,16v32c0,8.832,7.168,16,16,16h352c8.832,0,16-7.168,16-16v-32 C432,423.168,424.832,416,416,416z" />
        </svg>
      </a>

      <a (click)="createComment(row)">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAAl0lEQVRIiWNgGAUkAA8GBobHDAwM/ynEDxkYGNywWfCICobD8H1sFsAkKQHMUDP+wASYKDSQIKC5BSwE5IkNMkZcEtT2AYaDCPkAp8uI1Teo44Ao3w3ZOICDIZvRsKaix1Ca3ALuNwMDQzg+Wz0YKC9R/0Dpf6R7mjAoR7KIJhYgW0IzC2CWwC1gpoEFRxkgqegADczGBADWA1owfhpmmQAAAABJRU5ErkJggg=="/>   
      </a>
     
    </div>
  </ng-template>

  <ng-template #openCommentEY let-row>
      <button class='counter-item' [ngClass]="row.openCommentsEY > 0 ? 'has-count': 'zero-count'" color="primary">
      {{row.openCommentsEY}}
      </button>
  </ng-template>

  <ng-template #openCommentClient let-row>
      <button class='counter-item' [ngClass]="row.openCommentsClient > 0 ? 'has-count': 'zero-count'" color="primary">
        {{row.openCommentsClient}}
      </button>
  </ng-template>

  <ng-template #assignedToTemplate let-row>
    <div class="comment-user mt-2" *ngFor="let user of row.assignedTo; let i = index">
      <div class="header-avatar" *ngIf="i < 2">
        <motif-avatar [userName]="user.userFistName +' '+ user.userLastName" status="none"></motif-avatar>
      </div>     
    </div>
  
    <div class="margin-tooltip mt-2" *ngIf="row.assignedTo.length > 0">
        <motif-tooltip placement="bottom" >
            <h4 motifTooltipTrigger aria-label="tooltip" class="link-assigned"><b>+{{row.assignedTo.length-2}}</b></h4>
             <div *ngFor="let item of row.assignedTo; let x = index" >
               <span *ngIf="x > 1">{{item.userFistName + " " + item.userLastName}}</span>
             </div>          
        </motif-tooltip>                              
    </div> 

    <a class="cursor-pointer" (click)="addUsersToFund(row.id)" *ngIf="row.assignedTo.length == 0" >
      <svg width="24" height="14" viewBox="0 0 24 14" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M8 5.5H5V2.5H3V5.5H0V7.5H3V10.5H5V7.5H8V5.5ZM18 6.5C19.66 6.5 20.99 5.16 20.99 3.5C20.99 1.84 19.66 0.5 18 0.5C17.68 0.5 17.37 0.55 17.09 0.64C17.66 1.45 17.99 2.43 17.99 3.5C17.99 4.57 17.65 5.54 17.09 6.36C17.37 6.45 17.68 6.5 18 6.5ZM13 6.5C14.66 6.5 15.99 5.16 15.99 3.5C15.99 1.84 14.66 0.5 13 0.5C11.34 0.5 10 1.84 10 3.5C10 5.16 11.34 6.5 13 6.5ZM19.62 8.66C20.45 9.39 21 10.32 21 11.5V13.5H24V11.5C24 9.96 21.63 9.01 19.62 8.66ZM13 8.5C11 8.5 7 9.5 7 11.5V13.5H19V11.5C19 9.5 15 8.5 13 8.5Z" fill="#155CB4"/>
      </svg>        
    </a>

</ng-template>
</div>

