<div class="breadcrumb-container">
    <motif-breadcrumb>
        <motif-breadcrumb-item
         class="breadcrumb-first"
         *ngIf="parentModule === 'Regulatory Reporting'"
         breadcrumbValue="Regulatory Reporting"
         breadcrumbLink="/app-regulatory-filing">
        </motif-breadcrumb-item>

        <motif-breadcrumb-item
         class="breadcrumb-first"
         *ngIf="parentModule === 'Data Intake'"
         breadcrumbValue="Data Intake"
         breadcrumbLink="/data-intake-landing">
        </motif-breadcrumb-item>

        <motif-breadcrumb-item
        class="breadcrumb-first"
        *ngIf="parentModule === 'Regulatory Reporting'"
        breadcrumbValue="{{filingName}} // {{period}}" (click)="backtoParent(stage)"> 
        </motif-breadcrumb-item>

        <motif-breadcrumb-item
         breadcrumbValue="{{ exceptionReportName }}">
        </motif-breadcrumb-item>

    </motif-breadcrumb>
  </div>
  <div class="card-header-wrapper">
  
      <div class="view-exceptions-header-container">
        <h2 *ngIf="parentModule === 'Regulatory Reporting'" class="motif-h2">{{filingName}} // {{period}} // {{exceptionReportName}}</h2>
        <h2 *ngIf="parentModule === 'Data Intake'" class="motif-h2">{{filingName}} // {{exceptionReportName}}</h2>
        <span class="date-info" *ngIf="parentModule === 'Regulatory Reporting'"><motif-icon class="cust-date-motif-icon" [src]="'/assets/icons/action/ic_date_range_24px.svg'"></motif-icon>Due Date: {{ dueDate | date: 'M/d/yyyy' }}</span>
      </div>
  
  </div>


  <div class="exceptionResults">
    <lib-shared-grid
      (newEventToParent)="redirecttoDataExplorer($event)" 
      [columnDefs]="exceptionAnswersDefs" 
      [rowData]="exceptionAnswersData"
      [buttonText]="'Data Explorer'"
      rowSelection="multiple"
      buttonPosition="left"
      [defaultColDef]="{}"
      [disableAddMemberButton]="false"
      gridStyle="third"
      [noData]="'No exceptions found'"
      [displayCheckBox]="true"
      [pagination]="true"
      [export]="true" (exportFlagToParent)="exportData()">
    </lib-shared-grid>
    <ng-template #commentExceptionTemplate let-row>
      <div *ngIf="commentsCount[row.AuditResultObjectID] && permissions.validatePermission(componentStage, 'View Comments')"  class="comments-background" (click)="openComments(row)">
          {{commentsCount[row.AuditResultObjectID]}}
      </div>
      <div class="commentTemplate" *ngIf="!commentsCount[row.AuditResultObjectID] && permissions.validatePermission(componentStage, 'Add Comments') && !(filingDetails.status[4].progress === null || filingDetails.status[4].progress === 'COMPLETED' || filingDetails.status[4].progress === 'Completed')">
        <div class="add_icon">
            <motif-icon [src]="'/assets/icons/editor/ic_mode_comment_24px.svg'" (click)="addCommentToException(row)"><span class="plus">+</span></motif-icon>
        </div>
      </div>
  </ng-template>
  <ng-template #exceptionResultTemplate let-row>
    <div class="actionButtonTemplate">
        <!-- <motif-icon class="complete" *ngIf="row?.Status == 'No Exception'" [src]="'/assets/icons/action/ic_done_24px.svg'">
        </motif-icon> -->

        <div class="result_complete"
        *ngIf="(row?.Status == 'Resolved') && permissions.validatePermission(componentStage, 'View Comments')">
            <motif-icon [src]="'/assets/icons/av/ic_playlist_add_check_24px.svg'" (click)="openComments(row)"></motif-icon>
        </div>
        <div class="result_warning" *ngIf="row?.Status == 'Unresolved' || row?.Status == '' ">
            <motif-icon [src]="'/assets/icons/alert/ic_warning_24px.svg'"></motif-icon>
        </div>
    </div>
</ng-template>

<ng-template #actionResolvedTemplate let-row>
  <div class="actionResolvedTemplate" [hidden]="!this.permissions.validatePermission(componentStage, 'Exception Status Change Resolve') && (filingDetails.status[4].progress === null || filingDetails.status[4].progress === 'COMPLETED' || filingDetails.status[4].progress === 'Completed')">
    <div *ngIf="row?.Status == 'Unresolved' || row?.Status == '' " (click)="actionResolvedClick(row)">
      <svg width="14" height="14" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.15243 13.25H1.45968C0.649558 13.25 0 12.5949 0 11.7778V1.47222C0 0.65514 0.649558 0 1.45968 0H11.6774C12.4876 0 13.1371 0.65514 13.1371 1.47222V7.2139C12.6919 6.95626 12.2029 6.77223 11.6774 6.6839V1.47222H1.45968V11.7778H6.62695C6.71453 12.3078 6.89699 12.801 7.15243 13.25ZM10.2175 13.2501L8.21045 11.0417L9.05707 10.1878L10.2175 11.3582L12.8376 8.7156L13.6843 9.75352L10.2175 13.2501ZM2.91938 10.3056H6.56858V8.83336H2.91938V10.3056ZM8.52455 7.36113H2.91938V5.88891H10.2178V6.68391C9.59742 6.78696 9.02814 7.02252 8.52455 7.36113ZM2.91938 4.41668H10.2178V2.94445H2.91938V4.41668Z" fill="#155CB4"/>
        </svg>
    </div>
    <!-- <div *ngIf="row?.resolved" (click)="actionUnResolvedClick(row)">
        <svg width="14" height="14" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.29154 2.29134C3.49987 1.08301 5.1582 0.333008 6.99987 0.333008C10.6832 0.333008 13.6582 3.31634 13.6582 6.99967C13.6582 10.683 10.6832 13.6663 6.99987 13.6663C3.89154 13.6663 1.29987 11.5413 0.558205 8.66634H2.29154C2.97487 10.608 4.82487 11.9997 6.99987 11.9997C9.7582 11.9997 11.9999 9.75801 11.9999 6.99967C11.9999 4.24134 9.7582 1.99967 6.99987 1.99967C5.61654 1.99967 4.3832 2.57467 3.4832 3.48301L6.16654 6.16634H0.333204V0.333008L2.29154 2.29134Z" fill="#155CB4"/>
          </svg>          
    </div> -->
    <span *ngIf="row?.Status == 'Unresolved' || row?.Status == '' " class="actionResolvedTemplate-tooltip">Mark as Resolved</span>
  </div>
</ng-template>
  </div>

  <lib-comment-side-menu [(show)]="showComments" [entityId]="entityId" [entityType]="commentEntityType"
    [filingName]="commentsName" [filingStatus]="(filingDetails.status[4].progress === null || filingDetails.status[4].progress === 'COMPLETED' || filingDetails.status[4].progress === 'Completed')" 
    [permissionToAddComment]="permissions.validatePermission(componentStage, 'Add Comments')"
    (commentAddedEmitter)="commentAdded()"></lib-comment-side-menu>

  
  
  
  
  
  